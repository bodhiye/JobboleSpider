{"url_object_id": "883f88d012ee53f414b39b6c2be2e158", "title": "MySQL 创始人：写代码比打游戏还爽，程序员应该多泡开源社区", "url": "http://blog.jobbole.com/112366/", "create_date": "2017/09/05", "front_image_url": ["https://pic.36krcnd.com/avatar/201708/31082811/du4b3zkobsgzg70e.jpeg!1200"], "praise_nums": "1", "comment_nums": 0, "fav_nums": 0, "tags": "职场,MySQL", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://blog.openocean.vc/founder-stories-a-hackers-hacker-6d5054c90564\">OpenOcean</a>   译文出处：<a target=\"_blank\" href=\"http://36kr.com/p/5090841.html\">36氪</a>   </div><p>编者按：根据StackOverflow的最新调查，MySQL仍然是全世界最流行的数据库，受访的开发者中有44.3%的人在使用，超过了第二位的SQL Server 10多个百分点。可是你知道MySQL是怎么诞生的吗？openocean 的一篇有关MySQL开发者Michael “Monty” Widenius的传记为我们揭秘。</p>\n<p><span class=\"load-html-img loaded\"><img class=\"aligncenter\" src=\"https://pic.36krcnd.com/avatar/201708/31082811/du4b3zkobsgzg70e.jpeg!1200\" alt=\"MySQL创始人：写代码比打游戏还爽，程序员应该多泡开源社区\"></span></p>\n<p>大学计算机专业的数量总是会随着技术公司的兴衰而起伏，而现在，计算机科学正处在全盛时期。这意味着，不管怎样，计算机科学专业的毕业生绝大部分可能都会去敲2年的代码，再转到产品管理，然后过渡到企业、创业或者商学院，接着再转为既有公司的中层管理，32岁的时候结婚，有了2个孩子，一个儿子，一个女儿，一条狗，还有一栋2层的漂亮房子。对于大多数人来说，成为程序员就是一份朝九晚五的工作，一份有保障的6位数薪水来偿还高昂的学费，一种达到目的的手段，没人应该为此受到责备。但对于千千万万无论好坏的程序员来说，只有一个Monty Widenius。</p>\n<p>Monty是一位编程天才。19岁的时候，他从赫尔辛基理工大学辍学开始全职工作，因为大学已经没有什么东西可以教他了。在独自一人写完除了一个库以外的全部代码之后，33岁时，他发布了MySQL，后来后者成为了全世界最流行的开源数据库。55岁时，他藐视着对老年人的歧视，仍然是自己公司最好的程序员。</p>\n<p>Monty1962年出生于赫尔辛基，1978年他用暑假铺沥青挣来的钱买下自己的第一台个人计算机的。Monty迅速意识到自己相当擅长写代码——对于别人来说很复杂的事情他却觉得很简单，而且他对工作非常投入。Monty用一种在讲瑞典语的芬兰人中常见的浓厚口音说：“基本上这就像是在阅读一本真的非常非常好的书。或者像在玩视频游戏。你知道开始玩游戏然后嘣一声3小时的时间就过去了的那种感觉吗？写代码对我来说就是这种感觉。”</p>\n<p>当别人跑去聚会的时候，Monty却呆在家里编程。他把计算机从里到外都摸透了。他把BASIC的能力推到了极限。Monty说：“学校并不理解编程不是像语言或者历史这样的东西，它不是靠学就能学来的。所以学校是不够的。拔尖的黑客是万里挑一。他们奉献了所有能用的时间，10小时，16小时，每一天，年复一年周而复始。大多数人都不愿意做这样的事情。大多数人宁愿好好生活。”在Monty眼里，好的代码是写过一次就永远不需要再碰的那种。从性能角度来看它已经是最优化了，你可以不断增强，但永远都不需要重写。</p>\n<p>到1980年，17岁的Monty痴迷编程已经无法自拔，他需要把自己计算机的内存从8KB扩到16KB。由于芬兰没有商店卖他想要的东西，于是他弄了一条船去到瑞典Allan Larsson的计算机商店。通过Allan，Monty结识了David Axmark，三人沟通交流了多年，就各自项目互相帮忙，偶尔也会一起协作。1995年，他们一起成立了MySQL AB。Monty负责编程，David和Allan负责干完其他的事情。自1981年以来，Monty就一直以芬兰公司Tapio Laakso Oy程序员的身份在写MySQL前身的代码，他和Allan一起创办的数据仓库公司也要用到那个东西。然而，知道1995年，在Allan和David的游说之后Monty才决定在他写的东西之上增加一个SQL层。1996年10月，MySQL终于发布了，它得到了广泛的欢迎。MySQL快速、可靠并且易学，这主要是因为在多年的开发中Monty总是不断把正是客户的反馈整合进来。</p>\n<p>MySQL的初衷是存储和管理大数据。如果有人想要跟踪不同的数据点，他们互使用数据库，也就是有点像微软Excel那样的东西。然而，随着数据变得越来越大，查找Excel这样的数据库就会变得慢多了，也不再可靠。MySQL有能力存储大量数据，并且返回搜索结果极其迅速。“My”来自Monty女儿的名字，而“SQL”就是结构化查询语言（Structured Query Language）的意思，是一种跟数据库沟通的语言。</p>\n<p>对MySQL开源的决定出自1985年的另一次芬兰到瑞典的乘船旅行，这一次是在一场开源大会上。Monty说：“讨论没花多少分钟。我们都希望回馈给开源社区一点东西。哪怕有人想拷贝或者偷盗我们的代码，我们认为自己能挣的钱也不会比现在少。”开源项目使得开发者社区帮助把软件做得更好，但从商业角度来看不好的是货币化就要困难多了。为了避免这一点，Monty补充了一个条款，那就是如果任何企业用MySQL来赚钱的话，就需要付费授权。对此MySQL的代码里面并没有进行任何限制，但就靠这一荣誉制度MySQL实现了扩张并开始赚钱。Monty说：“我认为开源是开发软件的更好方式。但你仍然需要赚够钱来招聘员工，成立公司去跟闭源社区竞争。MySQL是第一款做到这一点的产品。”</p>\n<p>Monty在MySQL AB的职位是CTO，对于大多数成熟的公司来说，CTO其实已经很少再编程的了。然而，Monty从未停下来过，他的绝大部分时间都是在写代码。这种（很少管理的）做法会导致很多晚期阶段初创企业内爆，但哪怕公司人数已经达到550人，Monty在MySQL AB建立的独特文化也使得他可以避免天天开会的烦扰（事实上，Monty甚至都不接受议事日程邀请）。Monty说：“我总是招会自动驾驶的人进来。所以我不需要告诉他们太多东西。而开源意味着你有开源社区，大家会给你提供代码，你可以看看那些代码的质量，看看他们是怎么跟社区互动的，跟你是怎么沟通的，他们会问什么问题，在这些情况下很容易就能看出一个人是好是坏。在一次面试里面是很难了解清楚编码者有多好的。”</p>\n<p>MySQL的成功是CTO Monty与CEO Mårten Mickos通力协作的结果。两人能力都很强且对公司非常重要，但方式不一样。Monty是技术专家，专注于员工生产出尽量完美的代码。Mårten是公司建设者，专注于交付东西并帮助团队发展。正是两人的联合愿景制造出了MySQL。但在一家没有免费洗衣、免费午餐、站立办公桌的公司里，是Monty的个人魅力吸引住了变成人才。Monty不是好交际的筹资人，讨好别人的人，博弈论大师，或者职业沟通者。他会写代码，而且写得很好。在Monty看来赢得开发者尊重是很简单的事情：“你干的是跟他们一样的事，而且干得更好。”</p>\n<p><strong>Monty给程序员的建议是，参与到开源社区去，花些时间到个人项目里面</strong>（“这些年来我开发了成百上千个程序：MySQL是其中被用得最多的一个，但其他的都只有我自己用。”）。他警告说，改变环境和代码库将意味着哪怕是最好的程序员也要去了解一堆的东西。在Sun被Oracle收购之后，Monty成立了MariaDB，这是MySQL的一个社区版的分支，开发的团队成员很多都是MySQL团队里面的，使用的也是一样的官方语言：“蹩脚的英语”。MySQL的许多热心的开源信徒跟着Monty去到了MariaDB。MariaDB更加面向开发者，允许由外人打补丁这样的事情发生，在很多Linux发行版中它都是默认的数据库。</p>\n<p>Monty对开源和开发者的承诺是坚定的——OpenOcean原先是Monty用自己在MySQL的所得成立的，使命是投身于开发者驱动、有技术深度的产品。他仍然在赫尔辛基自己家中主持开发者午餐，很快OpenOcean就将推出一个Slack频道让开发者可以直接向Monty提问。在几十年的时间里，Monty对塑造开源社区无私的形象做出的贡献无可争议的。但这里面大部分的功劳都应该归到成千上万无名的程序员和黑客身上，是他们投入的时间和能力造就了开源的繁荣，也是这批人才能确保开源革命的继续。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112366\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112366votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112366\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": "full/0c3f9ba3f4a5ba0b302eafe8fdee79036cb5f3b1.jpg"}
{"url_object_id": "132543f366021bfbe319524538ba0b5d", "title": "树形结构数据存储方案（五）：区间嵌套", "url": "http://blog.jobbole.com/112339/", "create_date": "2017/09/03", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/03/4bae6998d00f180d42c7da716e3d0bb2.jpg"], "praise_nums": "1", "comment_nums": 0, "fav_nums": 0, "tags": "IT技术,数据库", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"https://www.biaodianfu.com/nested-intervals.html\">标点符</a>   </div><p>前面的一篇文章介绍了<a href=\"http://blog.jobbole.com/112323/\">左右值编码</a>，不知道大家注意到了没有，如果数据庞大，每次更新都需要更新差不多全表，效率较低没有更好的方式？今天我们就来研究下区间嵌套法。</p>\n<p><strong>区间嵌套法原理</strong></p>\n<p>如果节点区间[clft, crgt]与[plft, prgt]存在如下关系：plft &lt;= clft and crgt &gt;= prgt，则[clft, crgt]区间里的点是[plft, prgt]的子节点。基于此假设我们就可以通过对区间的不断的向下划来获取新的区间。举例：如果在区间[plft, prgt]中存在一个空白区间[lft1, rgt1]，如果要加入一个[plft,lft1]、[rgt1,prgt]同级的区间，只需插入节点：[(2*lft1+rgt1)/3,  (rgt1+2*lft)/3]。在添加完节点后我们还留下[lft1,(2*lft1+rgt1)/3]和 [(rgt1+2*lft)/3,rgt1]两个空余的空间用来添加更多的子节点。</p>\n<p><img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/09/94d451042cd71b68d4b44369f8ecff49.png\" alt=\"nested-intervals\" width=\"575\" height=\"100\">如果我们把区间放在二位平面上，把rgt当成是x轴，lft当做是y轴，纳闷嵌套的区间数差不多是这样的：</p>\n<p><img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/09/6e99479d95abda03131d9100ec75ec0f.png\" alt=\"nested-intervals-2\" width=\"500\" height=\"500\"></p>\n<p>每个节点[lft, rgt]拥有的子节点都被包含在y &gt;= lft &amp; x &lt;= rgt中。同时y &gt;= clft &amp; x &lt;= crgt所在的空间也是y &gt;= plft  &amp; x &lt;= prgt的子集。另外由于新增的右区间都小于已有的左区间，所以新增的节点均在y=x这条直线以下。</p>\n<p><strong>区间嵌套法实现</strong></p>\n<p>了解了区间嵌套法的原理后，接下来我们就要考虑如何实现他，原则上初始的区间使用任何区间都是可以的，这里我们使用的是[0,1]作为根区间。</p>\n<p><img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/09/81fa2963538889e727c4b2e0ba0e9df5.png\" alt=\"nested-intervals-3\" width=\"594\" height=\"594\"></p>\n<p>首先，我们在XY平面上定义2个点。深度优先集合点和广度有限集合点，针对点&lt;x=1,y=1/2&gt;的深度优先集合点为&lt;x=1,y=1&gt;，广度优先集合点为&lt;x=1/2,y=1/2&gt;。接下来我们定义第一个子节点的位置为父节点和深度优先集合点的中间点。兄弟节点则为前一个子节点到广度优先集合点的中间点，如上图所示，节点1.2的位置为&lt;x=3/4, y=5/8&gt;。</p>\n<p>另外仔细看我们可以看到点与点之间的关系。另外如果我们知道x和y的和，我们就能反推出x,y的值（具体的逻辑是什么，我现在也还没有搞懂，有知道的朋友可以帮忙解释下）。</p>\n<p>我们以节点&lt;x=3/4, y=5/8&gt;为例，我们可以得到他的和为11/8。</p>\n<p>我们定义11为分子（numerator），8为分母（denominator），则x点的分子为：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59adce3c0d5ac092754962\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nCREATE DEFINER = `root`@`localhost` FUNCTION `x_numer`(`numer` int,`denom` int)\r\n RETURNS int(11)\r\nBEGIN\r\n\tDECLARE ret_num INT;\r\n\tDECLARE ret_den INT;\r\n\tSET ret_num := numer+1;\r\n\tSET ret_den := denom*2;\r\n\tWHILE floor(ret_num/2) = ret_num/2 DO\r\n\t\tSET ret_num := ret_num/2;\r\n\t\tSET ret_den := ret_den/2;\r\n\tEND WHILE;\r\n\tRETURN ret_num;\r\nEND;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ac092754962-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ac092754962-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ac092754962-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ac092754962-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ac092754962-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ac092754962-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ac092754962-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ac092754962-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ac092754962-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ac092754962-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ac092754962-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ac092754962-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ac092754962-13\">13</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ac092754962-1\"><span class=\"crayon-e\">CREATE </span><span class=\"crayon-v\">DEFINER</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">root</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">@</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">localhost</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">FUNCTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">x_numer</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ac092754962-2\"><span class=\"crayon-h\"> </span><span class=\"crayon-e\">RETURNS </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ac092754962-3\"><span class=\"crayon-e\">BEGIN</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ac092754962-4\"><span class=\"crayon-e\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ret_num </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ac092754962-5\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ret_den </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ac092754962-6\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">numer</span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ac092754962-7\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">denom*</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ac092754962-8\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">floor</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">DO</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ac092754962-9\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ac092754962-10\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ac092754962-11\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ac092754962-12\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ac092754962-13\"><span class=\"crayon-st\">END</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0029 seconds] -->\r\n<p>x点的分母为：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59adce3c0d5c0428257273\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nCREATE DEFINER = `root`@`localhost` FUNCTION `x_ denom`(`numer` int,`denom` int)\r\n RETURNS int(11)\r\nBEGIN\r\n\tDECLARE ret_num INT;\r\n\tDECLARE ret_den INT;\r\n\tSET ret_num := numer+1;\r\n\tSET ret_den := denom*2;\r\n\tWHILE floor(ret_num/2) = ret_num/2 DO\r\n\t\tSET ret_num := ret_num/2;\r\n\t\tSET ret_den := ret_den/2;\r\n\tEND WHILE;\r\n\tRETURN ret_den;\r\nEND;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c0428257273-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c0428257273-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c0428257273-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c0428257273-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c0428257273-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c0428257273-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c0428257273-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c0428257273-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c0428257273-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c0428257273-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c0428257273-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c0428257273-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c0428257273-13\">13</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c0428257273-1\"><span class=\"crayon-e\">CREATE </span><span class=\"crayon-v\">DEFINER</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">root</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">@</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">localhost</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">FUNCTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-e\">x_ </span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c0428257273-2\"><span class=\"crayon-h\"> </span><span class=\"crayon-e\">RETURNS </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c0428257273-3\"><span class=\"crayon-e\">BEGIN</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c0428257273-4\"><span class=\"crayon-e\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ret_num </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c0428257273-5\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ret_den </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c0428257273-6\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">numer</span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c0428257273-7\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">denom*</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c0428257273-8\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">floor</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">DO</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c0428257273-9\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c0428257273-10\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c0428257273-11\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c0428257273-12\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c0428257273-13\"><span class=\"crayon-st\">END</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0028 seconds] -->\r\n<p>Y点的分子:</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59adce3c0d5c5038561721\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nCREATE DEFINER = `root`@`localhost` FUNCTION `y_numer`(`numer` int,`denom` int)\r\n RETURNS int(11)\r\nBEGIN\r\n\tDECLARE num INT;\r\n\tDECLARE den INT;\r\n\tSET num := x_numer(numer, denom);\r\n\tSET den := x_denom(numer, denom);\r\n\tWHILE den &lt; denom DO\r\n\t\tSET num := num*2;\r\n\t\tSET den := den*2;\r\n\tEND WHILE;\r\n\tSET num := (numer - num);\r\n\tWHILE floor(num/2) = num/2 DO\r\n\t\tSET num := num/2;\r\n\t\tSET den := den/2;\r\n\tEND WHILE;\r\n\tRETURN num;\r\nEND;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c5038561721-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c5038561721-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c5038561721-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c5038561721-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c5038561721-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c5038561721-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c5038561721-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c5038561721-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c5038561721-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c5038561721-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c5038561721-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c5038561721-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c5038561721-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c5038561721-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c5038561721-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c5038561721-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c5038561721-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c5038561721-18\">18</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c5038561721-1\"><span class=\"crayon-e\">CREATE </span><span class=\"crayon-v\">DEFINER</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">root</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">@</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">localhost</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">FUNCTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">y_numer</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c5038561721-2\"><span class=\"crayon-h\"> </span><span class=\"crayon-e\">RETURNS </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c5038561721-3\"><span class=\"crayon-e\">BEGIN</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c5038561721-4\"><span class=\"crayon-e\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">num </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c5038561721-5\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">den </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c5038561721-6\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">x_numer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c5038561721-7\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">x_denom</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c5038561721-8\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">denom </span><span class=\"crayon-st\">DO</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c5038561721-9\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">num*</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c5038561721-10\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">den*</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c5038561721-11\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c5038561721-12\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">num</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c5038561721-13\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">floor</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">num</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">num</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">DO</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c5038561721-14\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">num</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c5038561721-15\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">den</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c5038561721-16\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c5038561721-17\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">num</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c5038561721-18\"><span class=\"crayon-st\">END</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0039 seconds] -->\r\n<p>Y 的分母：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59adce3c0d5c9817196228\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nCREATE DEFINER = `root`@`localhost` FUNCTION `y_denom`(`numer` int,`denom` int)\r\n RETURNS int(11)\r\nBEGIN\r\n\tDECLARE num INT;\r\n\tDECLARE den INT;\r\n\tSET num := x_numer(numer, denom);\r\n\tSET den := x_denom(numer, denom);\r\n\tWHILE den &lt; denom DO\r\n\t\tSET num := num*2;\r\n\t\tSET den := den*2;\r\n\tEND WHILE;\r\n\tSET num := (numer - num);\r\n\tWHILE floor(num/2) = num/2 DO\r\n\t\tSET num := num/2;\r\n\t\tSET den := den/2;\r\n\tEND WHILE;\r\n\tRETURN den;\r\nEND;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c9817196228-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c9817196228-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c9817196228-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c9817196228-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c9817196228-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c9817196228-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c9817196228-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c9817196228-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c9817196228-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c9817196228-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c9817196228-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c9817196228-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c9817196228-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c9817196228-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c9817196228-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c9817196228-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5c9817196228-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5c9817196228-18\">18</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c9817196228-1\"><span class=\"crayon-e\">CREATE </span><span class=\"crayon-v\">DEFINER</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">root</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">@</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">localhost</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">FUNCTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">y_denom</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c9817196228-2\"><span class=\"crayon-h\"> </span><span class=\"crayon-e\">RETURNS </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c9817196228-3\"><span class=\"crayon-e\">BEGIN</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c9817196228-4\"><span class=\"crayon-e\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">num </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c9817196228-5\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">den </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c9817196228-6\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">x_numer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c9817196228-7\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">x_denom</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c9817196228-8\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">denom </span><span class=\"crayon-st\">DO</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c9817196228-9\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">num*</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c9817196228-10\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">den*</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c9817196228-11\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c9817196228-12\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">num</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c9817196228-13\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">floor</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">num</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">num</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">DO</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c9817196228-14\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">num</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c9817196228-15\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">den</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c9817196228-16\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5c9817196228-17\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">den</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5c9817196228-18\"><span class=\"crayon-st\">END</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0038 seconds] -->\r\n<p>接下来我们来测试下，X与Y是否能解码出来：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59adce3c0d5cc361402877\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nSELECT\r\n\tCONCAT(x_numer (11, 8),'/',x_denom (11, 8)) AS X,\r\n\tCONCAT(y_numer (11, 8),'/',y_denom (11, 8)) AS Y</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5cc361402877-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5cc361402877-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5cc361402877-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59adce3c0d5cc361402877-1\"><span class=\"crayon-e\">SELECT</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5cc361402877-2\"><span class=\"crayon-e\">\t</span><span class=\"crayon-e\">CONCAT</span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">x_numer</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">8</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">'/'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-e\">x_denom</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">8</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">AS</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">X</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5cc361402877-3\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">CONCAT</span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">y_numer</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">8</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">'/'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-e\">y_denom</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">8</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">AS</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Y</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0015 seconds] -->\r\n<p><img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/09/bbeb82483ee93ccefe1247f25950d91a.png\" alt=\"result\" width=\"232\" height=\"83\"></p>\n<p>结果与节点1.2的位置为&lt;x=3/4, y=5/8&gt;完全一致。现在我们知道只需要一个分数即可表示平面上的一个点。</p>\n<p>如有已经有分数11/8如何获取该节点的父节点？(如果分子为3，则代表其为根节点)</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59adce3c0d5d0727099617\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nCREATE DEFINER = `root`@`localhost` FUNCTION `parent_numer`(`numer` int,`denom` int)\r\n RETURNS int(11)\r\nBEGIN\r\n\tDECLARE ret_num INT;\r\n\tDECLARE ret_den INT;\r\n\tIF numer=3 THEN\r\n\t\tRETURN denom/2;\r\n\tEND IF;\r\n\tSET ret_num := (numer-1)/2;\r\n\tSET ret_den := denom/2;\r\n\tWHILE floor((ret_num-1)/4) = (ret_num-1)/4 DO\r\n\t\tSET ret_num := (ret_num+1)/2;\r\n\t\tSET ret_den := ret_den/2;\r\n\tEND WHILE;\r\n\tRETURN ret_num;\r\nEND;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d0727099617-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d0727099617-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d0727099617-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d0727099617-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d0727099617-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d0727099617-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d0727099617-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d0727099617-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d0727099617-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d0727099617-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d0727099617-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d0727099617-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d0727099617-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d0727099617-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d0727099617-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d0727099617-16\">16</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d0727099617-1\"><span class=\"crayon-e\">CREATE </span><span class=\"crayon-v\">DEFINER</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">root</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">@</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">localhost</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">FUNCTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">parent_numer</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d0727099617-2\"><span class=\"crayon-h\"> </span><span class=\"crayon-e\">RETURNS </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d0727099617-3\"><span class=\"crayon-e\">BEGIN</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d0727099617-4\"><span class=\"crayon-e\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ret_num </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d0727099617-5\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ret_den </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d0727099617-6\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">IF</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">numer</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">THEN</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d0727099617-7\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d0727099617-8\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">IF</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d0727099617-9\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d0727099617-10\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d0727099617-11\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">floor</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">4</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">DO</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d0727099617-12\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d0727099617-13\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d0727099617-14\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d0727099617-15\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d0727099617-16\"><span class=\"crayon-st\">END</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0034 seconds] -->\r\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59adce3c0d5d3119931404\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nSELECT CONCAT(parent_numer(11,8),'/',parent_denom(11,8)) AS parent</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d3119931404-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d3119931404-1\"><span class=\"crayon-e\">SELECT </span><span class=\"crayon-e\">CONCAT</span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">parent_numer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">8</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">'/'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-e\">parent_denom</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">8</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">AS</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">parent</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0010 seconds] -->\r\n<p>计算当前节点在同级所在的位置：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59adce3c0d5d6477778921\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nCREATE DEFINER = `root`@`localhost` FUNCTION `parent_denom`(`numer` int,`denom` int)\r\n RETURNS int(11)\r\nBEGIN\r\n\tDECLARE ret_num INT;\r\n\tDECLARE ret_den INT;\r\n\tIF numer=3 THEN\r\n\t\tRETURN NULL;\r\n\tEND IF;\r\n\tSET ret_num := (numer-1)/2;\r\n\tSET ret_den := denom/2;\r\n\tWHILE floor((ret_num-1)/4) = (ret_num-1)/4 DO\r\n\t\tSET ret_num := (ret_num+1)/2;\r\n\t\tSET ret_den := ret_den/2;\r\n\tEND WHILE;\r\n\tRETURN ret_den;\r\nEND;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d6477778921-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d6477778921-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d6477778921-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d6477778921-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d6477778921-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d6477778921-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d6477778921-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d6477778921-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d6477778921-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d6477778921-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d6477778921-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d6477778921-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d6477778921-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d6477778921-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5d6477778921-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5d6477778921-16\">16</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d6477778921-1\"><span class=\"crayon-e\">CREATE </span><span class=\"crayon-v\">DEFINER</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">root</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">@</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">localhost</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">FUNCTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">parent_denom</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d6477778921-2\"><span class=\"crayon-h\"> </span><span class=\"crayon-e\">RETURNS </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d6477778921-3\"><span class=\"crayon-e\">BEGIN</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d6477778921-4\"><span class=\"crayon-e\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ret_num </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d6477778921-5\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ret_den </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d6477778921-6\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">IF</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">numer</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">THEN</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d6477778921-7\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">NULL</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d6477778921-8\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">IF</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d6477778921-9\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d6477778921-10\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d6477778921-11\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">floor</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">4</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">DO</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d6477778921-12\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d6477778921-13\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d6477778921-14\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5d6477778921-15\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5d6477778921-16\"><span class=\"crayon-st\">END</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0036 seconds] -->\r\n<p>有了查询父节点的方法及当前节点所在同级中的位置的方法，即可通过这两个的组合，将节点的路径给计算出来。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59adce3c0d5da176950839\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nCREATE DEFINER = `root`@`localhost` FUNCTION `path`(`numer` int,`denom` int)\r\n RETURNS varchar(255)\r\nBEGIN\r\n\tIF numer is NULL THEN\r\n\t\tRETURN '';\r\n\tEND IF;\r\n\tRETURN path(parent_numer(numer, denom),parent_denom(numer, denom))|| ‘.’ || sibling_number(numer, denom);\r\nEND;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5da176950839-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5da176950839-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5da176950839-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5da176950839-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5da176950839-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5da176950839-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5da176950839-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5da176950839-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59adce3c0d5da176950839-1\"><span class=\"crayon-e\">CREATE </span><span class=\"crayon-v\">DEFINER</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">root</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">@</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">localhost</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">FUNCTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">path</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5da176950839-2\"><span class=\"crayon-h\"> </span><span class=\"crayon-e\">RETURNS </span><span class=\"crayon-e\">varchar</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">255</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5da176950839-3\"><span class=\"crayon-e\">BEGIN</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5da176950839-4\"><span class=\"crayon-e\">\t</span><span class=\"crayon-st\">IF</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">numer </span><span class=\"crayon-st\">is</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">NULL</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">THEN</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5da176950839-5\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">''</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5da176950839-6\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">IF</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5da176950839-7\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">path</span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">parent_numer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-e\">parent_denom</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">||</span><span class=\"crayon-h\"> </span>‘<span class=\"crayon-sy\">.</span>’<span class=\"crayon-h\"> </span><span class=\"crayon-o\">||</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sibling_number</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5da176950839-8\"><span class=\"crayon-st\">END</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0022 seconds] -->\r\n<p>按照以上方法添加后进行测试，返回[Err] 1424 – Recursive stored functions and triggers are not allowed. 即MySQL的自定义函数不支持递归查询。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59adce3c0d5dd212522296\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nCREATE DEFINER = `root`@`localhost` FUNCTION `path`(`numer` int,`denom` int)\r\n RETURNS varchar(255)\r\nBEGIN\r\n\tDECLARE numer_temp INT;\r\n\tDECLARE denom_temp INT;\r\n\tDECLARE path_result VARCHAR(255);\r\n\tDECLARE path_temp VARCHAR(255);\r\n\tDECLARE sn VARCHAR(255);\r\n\tSET path_temp := '';\r\n\tWHILE numer IS NOT NULL DO\r\n\t\tIF path_temp = ''\r\n\t\tTHEN\r\n\t\t\tSET path_result := sibling_number(numer, denom);\r\n\t\tELSE\r\n\t\t\tSET path_result := CONCAT(sibling_number(numer, denom),'.',path_temp);\r\n\t\tEND IF;\r\n\t\tSET path_temp := path_result;\r\n\t\tSET numer_temp := parent_numer(numer, denom);\r\n\t\tSET denom_temp := parent_denom(numer, denom);\r\n\t\tSET numer := numer_temp;\r\n\t\tSET denom := denom_temp;\r\n\tEND WHILE;\r\n\tRETURN path_result;\r\nEND;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5dd212522296-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5dd212522296-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5dd212522296-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5dd212522296-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5dd212522296-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5dd212522296-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5dd212522296-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5dd212522296-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5dd212522296-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5dd212522296-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5dd212522296-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5dd212522296-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5dd212522296-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5dd212522296-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5dd212522296-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5dd212522296-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5dd212522296-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5dd212522296-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5dd212522296-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5dd212522296-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5dd212522296-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5dd212522296-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5dd212522296-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5dd212522296-24\">24</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59adce3c0d5dd212522296-1\"><span class=\"crayon-e\">CREATE </span><span class=\"crayon-v\">DEFINER</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">root</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">@</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">localhost</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">FUNCTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">path</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5dd212522296-2\"><span class=\"crayon-h\"> </span><span class=\"crayon-e\">RETURNS </span><span class=\"crayon-e\">varchar</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">255</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5dd212522296-3\"><span class=\"crayon-e\">BEGIN</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5dd212522296-4\"><span class=\"crayon-e\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">numer_temp </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5dd212522296-5\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">denom_temp </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5dd212522296-6\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">path_result </span><span class=\"crayon-e\">VARCHAR</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">255</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5dd212522296-7\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">path_temp </span><span class=\"crayon-e\">VARCHAR</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">255</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5dd212522296-8\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sn </span><span class=\"crayon-e\">VARCHAR</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">255</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5dd212522296-9\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">path_temp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">''</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5dd212522296-10\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">numer </span><span class=\"crayon-st\">IS</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">NOT</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">NULL</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">DO</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5dd212522296-11\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-st\">IF</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">path_temp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">''</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5dd212522296-12\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-st\">THEN</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5dd212522296-13\"><span class=\"crayon-h\">\t\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">path_result</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sibling_number</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5dd212522296-14\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-st\">ELSE</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5dd212522296-15\"><span class=\"crayon-h\">\t\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">path_result</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">CONCAT</span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">sibling_number</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">'.'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">path_temp</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5dd212522296-16\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">IF</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5dd212522296-17\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">path_temp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">path_result</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5dd212522296-18\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">numer_temp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">parent_numer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5dd212522296-19\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">denom_temp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">parent_denom</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5dd212522296-20\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">numer</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">numer_temp</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5dd212522296-21\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">denom</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom_temp</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5dd212522296-22\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5dd212522296-23\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">path_result</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5dd212522296-24\"><span class=\"crayon-st\">END</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0046 seconds] -->\r\n<p>SELECT path (11, 8) 的结果为 1.2</p>\n<p>计算节点层级的方法：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59adce3c0d5e3928790228\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nCREATE DEFINER = `root`@`localhost` FUNCTION `node_level`(`numer` int,`denom` int)\r\n RETURNS int(11)\r\nBEGIN\r\n\tDECLARE ret_num INT;\r\n\tDECLARE ret_den INT;\r\n\tDECLARE ret INT;\r\n\tSET ret =1;\r\n\tIF numer=3 THEN\r\n\t\treturn 1;\r\n\tEND IF;\r\n\tWHILE numer!=3 DO\r\n\t\tSET ret_num := parent_numer(numer, denom);\r\n\t\tSET ret_den := parent_denom(numer, denom);\r\n\t\tSET numer := ret_num;\r\n\t\tSET denom := ret_den;\r\n\t\tSET ret := ret + 1;\r\n\tEND WHILE;\r\n\tRETURN ret;\r\nEND;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5e3928790228-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5e3928790228-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5e3928790228-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5e3928790228-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5e3928790228-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5e3928790228-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5e3928790228-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5e3928790228-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5e3928790228-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5e3928790228-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5e3928790228-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5e3928790228-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5e3928790228-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5e3928790228-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5e3928790228-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5e3928790228-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5e3928790228-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5e3928790228-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5e3928790228-19\">19</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59adce3c0d5e3928790228-1\"><span class=\"crayon-e\">CREATE </span><span class=\"crayon-v\">DEFINER</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">root</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">@</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">localhost</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">FUNCTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">node_level</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5e3928790228-2\"><span class=\"crayon-h\"> </span><span class=\"crayon-e\">RETURNS </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5e3928790228-3\"><span class=\"crayon-e\">BEGIN</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5e3928790228-4\"><span class=\"crayon-e\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ret_num </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5e3928790228-5\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ret_den </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5e3928790228-6\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ret </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5e3928790228-7\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5e3928790228-8\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">IF</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">numer</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">THEN</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5e3928790228-9\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5e3928790228-10\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">IF</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5e3928790228-11\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">numer</span><span class=\"crayon-o\">!=</span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">DO</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5e3928790228-12\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">parent_numer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5e3928790228-13\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">parent_denom</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">numer</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">denom</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5e3928790228-14\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">numer</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret_num</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5e3928790228-15\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">denom</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret_den</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5e3928790228-16\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">ret</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5e3928790228-17\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5e3928790228-18\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ret</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5e3928790228-19\"><span class=\"crayon-st\">END</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0036 seconds] -->\r\n<p>我们知道了如何将编码过的节点转成目录形式，如何逆转呢？以下是方法：</p>\n<p>先添加2个辅助函数：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59adce3c0d5e7531251840\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nCREATE DEFINER = `root`@`localhost` FUNCTION `child_numer`(`num` int,`den` int,`child` int)\r\n RETURNS int(11)\r\nBEGIN\r\n\tRETURN num * power(2, child) + 3 - power(2, child);\r\nEND;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5e7531251840-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5e7531251840-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5e7531251840-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5e7531251840-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5e7531251840-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59adce3c0d5e7531251840-1\"><span class=\"crayon-e\">CREATE </span><span class=\"crayon-v\">DEFINER</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">root</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">@</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">localhost</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">FUNCTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">child_numer</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">num</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">den</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span><span class=\"crayon-sy\">`</span><span class=\"crayon-r\">child</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5e7531251840-2\"><span class=\"crayon-h\"> </span><span class=\"crayon-e\">RETURNS </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5e7531251840-3\"><span class=\"crayon-e\">BEGIN</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5e7531251840-4\"><span class=\"crayon-e\">\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">num *</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">power</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">child</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">power</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">child</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5e7531251840-5\"><span class=\"crayon-st\">END</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0020 seconds] -->\r\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59adce3c0d5ea823629463\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nCREATE DEFINER = `root`@`localhost` FUNCTION `child_denom`(`num` int,`den` int,`child` int)\r\n RETURNS int(11)\r\nBEGIN\r\n\tRETURN den*power(2, child);\r\nEND;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ea823629463-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ea823629463-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ea823629463-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ea823629463-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ea823629463-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ea823629463-1\"><span class=\"crayon-e\">CREATE </span><span class=\"crayon-v\">DEFINER</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">root</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">@</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">localhost</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">FUNCTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">child_denom</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">num</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">den</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">,</span><span class=\"crayon-sy\">`</span><span class=\"crayon-r\">child</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ea823629463-2\"><span class=\"crayon-h\"> </span><span class=\"crayon-e\">RETURNS </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ea823629463-3\"><span class=\"crayon-e\">BEGIN</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ea823629463-4\"><span class=\"crayon-e\">\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">den*</span><span class=\"crayon-e\">power</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">child</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ea823629463-5\"><span class=\"crayon-st\">END</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0018 seconds] -->\r\n<p>再来编写逆转函数：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59adce3c0d5ed205381144\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nCREATE DEFINER = `root`@`localhost` FUNCTION `path_numer`(`path` varchar(255))\r\n RETURNS int(11)\r\nBEGIN\r\n\tDECLARE num INT;\r\n\tDECLARE den INT;\r\n\tDECLARE postfix VARCHAR(255);\r\n\tDECLARE sibling VARCHAR(255);\r\n\tSET num := 1;\r\n\tSET den := 1;\r\n\tSET postfix := CONCAT(path,'.');\r\n\tWHILE length(postfix) &gt; 1 DO\r\n\t\tSET sibling := SUBSTR(postfix, 1, instr(postfix,'.')-1);\r\n\t\tSET postfix := SUBSTR(postfix, instr(postfix,'.')+1);\r\n\t\tSET num := child_numer(num,den,sibling+0);\r\n\t\tSET den := child_denom(num,den,sibling+0);\r\n\tEND WHILE;\r\n\tRETURN num;\r\nEND;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ed205381144-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ed205381144-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ed205381144-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ed205381144-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ed205381144-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ed205381144-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ed205381144-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ed205381144-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ed205381144-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ed205381144-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ed205381144-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ed205381144-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ed205381144-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ed205381144-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ed205381144-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ed205381144-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5ed205381144-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5ed205381144-18\">18</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ed205381144-1\"><span class=\"crayon-e\">CREATE </span><span class=\"crayon-v\">DEFINER</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">root</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">@</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">localhost</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">FUNCTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">path_numer</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">path</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">varchar</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">255</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ed205381144-2\"><span class=\"crayon-h\"> </span><span class=\"crayon-e\">RETURNS </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ed205381144-3\"><span class=\"crayon-e\">BEGIN</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ed205381144-4\"><span class=\"crayon-e\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">num </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ed205381144-5\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">den </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ed205381144-6\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">postfix </span><span class=\"crayon-e\">VARCHAR</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">255</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ed205381144-7\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sibling </span><span class=\"crayon-e\">VARCHAR</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">255</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ed205381144-8\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ed205381144-9\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ed205381144-10\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">postfix</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">CONCAT</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">path</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">'.'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ed205381144-11\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">length</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">postfix</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">DO</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ed205381144-12\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">sibling</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SUBSTR</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">postfix</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">instr</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">postfix</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">'.'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ed205381144-13\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">postfix</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SUBSTR</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">postfix</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">instr</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">postfix</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">'.'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ed205381144-14\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">child_numer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">num</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">den</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">sibling</span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ed205381144-15\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">child_denom</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">num</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">den</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">sibling</span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ed205381144-16\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5ed205381144-17\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">num</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5ed205381144-18\"><span class=\"crayon-st\">END</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0047 seconds] -->\r\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59adce3c0d5f1307769104\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nCREATE DEFINER = `root`@`localhost` FUNCTION `path_denom`(`path` varchar(255))\r\n RETURNS int(11)\r\nBEGIN\r\n\tDECLARE num INT;\r\n\tDECLARE den INT;\r\n\tDECLARE postfix VARCHAR(255);\r\n\tDECLARE sibling VARCHAR(255);\r\n\tSET num := 1;\r\n\tSET den := 1;\r\n\tSET postfix := CONCAT(path,'.');\r\n\tWHILE length(postfix) &gt; 1 DO\r\n\t\tSET sibling := SUBSTR(postfix, 1, instr(postfix,'.')-1);\r\n\t\tSET postfix := SUBSTR(postfix, instr(postfix,'.')+1);\r\n\t\tSET num := child_numer(num,den,sibling+0);\r\n\t\tSET den := child_denom(num,den,sibling+0);\r\n\tEND WHILE;\r\n\tRETURN den;\r\nEND;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5f1307769104-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5f1307769104-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5f1307769104-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5f1307769104-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5f1307769104-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5f1307769104-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5f1307769104-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5f1307769104-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5f1307769104-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5f1307769104-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5f1307769104-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5f1307769104-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5f1307769104-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5f1307769104-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5f1307769104-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5f1307769104-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-59adce3c0d5f1307769104-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59adce3c0d5f1307769104-18\">18</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59adce3c0d5f1307769104-1\"><span class=\"crayon-e\">CREATE </span><span class=\"crayon-v\">DEFINER</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">root</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">@</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">localhost</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">FUNCTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">path_denom</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">path</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">varchar</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">255</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5f1307769104-2\"><span class=\"crayon-h\"> </span><span class=\"crayon-e\">RETURNS </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5f1307769104-3\"><span class=\"crayon-e\">BEGIN</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5f1307769104-4\"><span class=\"crayon-e\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">num </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5f1307769104-5\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">den </span><span class=\"crayon-t\">INT</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5f1307769104-6\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">postfix </span><span class=\"crayon-e\">VARCHAR</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">255</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5f1307769104-7\"><span class=\"crayon-h\">\t</span><span class=\"crayon-r\">DECLARE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sibling </span><span class=\"crayon-e\">VARCHAR</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">255</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5f1307769104-8\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5f1307769104-9\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5f1307769104-10\"><span class=\"crayon-h\">\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">postfix</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">CONCAT</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">path</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">'.'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5f1307769104-11\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">length</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">postfix</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">DO</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5f1307769104-12\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">sibling</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SUBSTR</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">postfix</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">instr</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">postfix</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">'.'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5f1307769104-13\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">postfix</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SUBSTR</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">postfix</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">instr</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">postfix</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">'.'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5f1307769104-14\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">num</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">child_numer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">num</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">den</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">sibling</span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5f1307769104-15\"><span class=\"crayon-h\">\t\t</span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">den</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">child_denom</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">num</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">den</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">sibling</span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5f1307769104-16\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">END</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">WHILE</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59adce3c0d5f1307769104-17\"><span class=\"crayon-h\">\t</span><span class=\"crayon-st\">RETURN</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">den</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59adce3c0d5f1307769104-18\"><span class=\"crayon-st\">END</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0045 seconds] -->\r\n<p>select CONCAT(path_numer(‘2.1.3′),’/’,path_denom(‘2.1.3’)) 结果为51/64</p>\n<p>参考资料：</p>\n<ul>\n<li>http://www.rampant-books.com/art_vadim_nested_sets_sql_trees.htm</li>\n</ul>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112339\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112339votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112339\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": "full/117976068e2e847f1067d25ea3fa90a3b5a60f3f.jpg"}
{"url_object_id": "16321b6a38d1ee394e7cc3ea90594078", "title": "树形结构数据存储方案（二）： 物化路径", "url": "http://blog.jobbole.com/112312/", "create_date": "2017/08/31", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2012/03/database-logo.png"], "praise_nums": "1", "comment_nums": 1, "fav_nums": 1, "tags": "IT技术,数据库", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"https://www.biaodianfu.com/path-enumeration.html\">标点符</a>   </div><p>前一篇文章介绍了比较简单的<a href=\"http://blog.jobbole.com/112309/\">邻接列表模式</a>，物化路径其实更加容易理解，其实就是在创建节点时，将节点的完整路径进行记录。以下图为例：</p>\n<p><img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/91ae30cffcfe91c0ebd3e6091f970295.jpg\" alt=\"tree\" width=\"231\" height=\"259\"></p>\n<p>按照Path Enumeration 进行存储后的结果如下：</p>\n<p><img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/d1a1da59ee04bd6479425f929f1da5d0.png\" alt=\"Path-Enumeration\" width=\"252\" height=\"221\"></p>\n<p>此种方案借助了unix文件目录的思想，主要时以空间换时间。</p>\n<p>查询某一节点下的所有子节点:（以Fruit为例）</p>\n<div id=\"crayon-59a6b897c213a519548061-1\"></div>\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59ae00ee32e9a904358985\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nSET @path = (SELECT path FROM pathTree WHERE node_name = 'Fruit');\r\nSELECT * FROM pathTree WHERE path like CONCAT(@path,'/%');</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59ae00ee32e9a904358985-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59ae00ee32e9a904358985-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59ae00ee32e9a904358985-1\"><span class=\"crayon-i\">SET</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">path</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">SELECT </span><span class=\"crayon-e\">path </span><span class=\"crayon-e\">FROM </span><span class=\"crayon-e\">pathTree </span><span class=\"crayon-e\">WHERE </span><span class=\"crayon-v\">node_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'Fruit'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59ae00ee32e9a904358985-2\"><span class=\"crayon-e \">SELECT *</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">FROM </span><span class=\"crayon-e\">pathTree </span><span class=\"crayon-e\">WHERE </span><span class=\"crayon-e\">path </span><span class=\"crayon-e\">like </span><span class=\"crayon-e\">CONCAT</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">path</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">'/%'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0010 seconds] -->\r\n<p>如何查询直属子节点？需要采用MySQL的正则表达式查询：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59ae00ee32ea5277664595\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nSET @path = (SELECT path FROM pathTree WHERE node_name = 'Fruit');\r\nSELECT * FROM pathTree WHERE path REGEXP CONCAT(@path,'/','[0-9]$');</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59ae00ee32ea5277664595-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59ae00ee32ea5277664595-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59ae00ee32ea5277664595-1\"><span class=\"crayon-i\">SET</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">path</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">SELECT </span><span class=\"crayon-e\">path </span><span class=\"crayon-e\">FROM </span><span class=\"crayon-e\">pathTree </span><span class=\"crayon-e\">WHERE </span><span class=\"crayon-v\">node_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'Fruit'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59ae00ee32ea5277664595-2\"><span class=\"crayon-e \">SELECT *</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">FROM </span><span class=\"crayon-e\">pathTree </span><span class=\"crayon-e\">WHERE </span><span class=\"crayon-e\">path </span><span class=\"crayon-e\">REGEXP </span><span class=\"crayon-e\">CONCAT</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">path</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">'/'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">'[0-9]$'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0010 seconds] -->\r\n<p>查询任意节点的所有上级：（以Yellow为例）：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59ae00ee32ea9170370040\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nSET @path = (SELECT path FROM pathTree WHERE node_name = 'Yellow');\r\nSELECT * FROM pathTree WHERE @path LIKE CONCAT(path, '%') AND path &lt;&gt; @path;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59ae00ee32ea9170370040-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59ae00ee32ea9170370040-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59ae00ee32ea9170370040-1\"><span class=\"crayon-i\">SET</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">path</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">SELECT </span><span class=\"crayon-e\">path </span><span class=\"crayon-e\">FROM </span><span class=\"crayon-e\">pathTree </span><span class=\"crayon-e\">WHERE </span><span class=\"crayon-v\">node_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'Yellow'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59ae00ee32ea9170370040-2\"><span class=\"crayon-e \">SELECT *</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">FROM </span><span class=\"crayon-e\">pathTree </span><span class=\"crayon-i\">WHERE</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">@</span><span class=\"crayon-e\">path </span><span class=\"crayon-e\">LIKE </span><span class=\"crayon-e\">CONCAT</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">path</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'%'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">AND</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">path</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">path</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0012 seconds] -->\r\n<p>插入新增数据：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59ae00ee32ead309315508\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nSET @parent_path = ( SELECT path FROM pathTree WHERE node_name = 'Fruit');\r\nINSERT INTO pathtree (path,node_name) VALUES (CONCAT(@parent_path,'/',LAST_INSERT_ID()+1),'White')</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59ae00ee32ead309315508-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59ae00ee32ead309315508-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59ae00ee32ead309315508-1\"><span class=\"crayon-i\">SET</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">parent_path</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">SELECT </span><span class=\"crayon-e\">path </span><span class=\"crayon-e\">FROM </span><span class=\"crayon-e\">pathTree </span><span class=\"crayon-e\">WHERE </span><span class=\"crayon-v\">node_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'Fruit'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59ae00ee32ead309315508-2\"><span class=\"crayon-e\">INSERT </span><span class=\"crayon-e\">INTO </span><span class=\"crayon-e\">pathtree</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">path</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">node_name</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">VALUES</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">CONCAT</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">parent_path</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">'/'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-e\">LAST_INSERT_ID</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">'White'</span><span class=\"crayon-sy\">)</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>此方案的缺点是树的层级太深有可能会超过PATH字段的长度，所以其能支持的最大深度并非无限的。</p>\n<p>如果层级数量是确定的，可以再将所有的列都展开，如下图，比较试用于类似行政区划、生物分类法（界、门、纲、目、科、属、种）这些层级确定的内容。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/08/579dacd5167f484176573e5603f755c3.png\" alt=\"Multiple-lineage-columns\" width=\"609\" height=\"239\"></p>\n<p>参考文章：</p>\n<ul>\n<li>https://communities.bmc.com/docs/DOC-9902</li>\n</ul>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112312\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112312votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112312\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 1 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 1 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": "full/f42d1238aa0f889b8988c70dd7481c7a4bd3b456.jpg"}
{"url_object_id": "686dfefb107681a80169eabfd8e284a0", "title": "给中级 Meld 用户的实用技巧", "url": "http://blog.jobbole.com/112348/", "create_date": "2017/09/03", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2014/04/e260ae4f5d153b25be87819b25ff0577.jpg"], "praise_nums": "1", "comment_nums": 0, "fav_nums": 0, "tags": "IT技术,Linux", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://www.howtoforge.com/tutorial/beginners-guide-to-visual-merge-tool-meld-on-linux-part-2/\">Ansh</a>   译文出处：<a target=\"_blank\" href=\"https://linux.cn/article-8808-1.html\">Linux中国/geekpi</a>   </div><p>Meld 是 Linux 上功能丰富的可视化比较和合并工具。如果你是第一次接触，你可以进入我们的<a href=\"http://blog.jobbole.com/112344/\">初学者指南</a>，了解该程序的工作原理，如果你已经阅读过或正在使用 Meld 进行基本的比较/合并任务，你将很高兴了解本教程的东西，在本教程中，我们将讨论一些非常有用的技巧，这将让你使用工具的体验更好。</p>\n<p><em>但在我们跳到安装和解释部分之前，值得一提的是，本教程中介绍的所有说明和示例已在 Ubuntu 14.04 上进行了测试，而我们使用的 Meld 版本为 3.14.2</em>。</p>\n<h3 id=\"toc_1\">1、 跳转</h3>\n<p>你可能已经知道（我们也在初学者指南中也提到过这一点），标准滚动不是在使用 Meld 时在更改之间跳转的唯一方法 – 你可以使用向上和向下箭头键轻松地从一个更改跳转到另一个更改位于编辑区域上方的窗格中：</p>\n<p><a href=\"https://www.howtoforge.com/images/beginners-guide-to-visual-merge-tool-meld-on-linux-part-2/big/meld-go-next-prev-9.png\"> <img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/09/ffe53b7d64bad7dac95f36ba889bc13d.png\" alt=\"Navigating in Meld\"></a></p>\n<p>但是，这需要你将鼠标指针移动到这些箭头，然后再次单击其中一个（取决于你要去哪里 – 向上或向下）。你会很高兴知道，存在另一种更简单的方式来跳转：只需使用鼠标的滚轮即可在鼠标指针位于中央更改栏上时进行滚动。</p>\n<p><a href=\"https://www.howtoforge.com/images/beginners-guide-to-visual-merge-tool-meld-on-linux-part-2/big/meld-center-area-scrolling.png\"> <img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/09/84810b35573d599d2a5a3ef2d2ee916e.png\" alt=\"The change bar\"></a></p>\n<p>这样，你就可以在视线不离开或者分心的情况下进行跳转，</p>\n<h3 id=\"toc_2\">2、 可以对更改进行的操作</h3>\n<p>看下上一节的最后一个屏幕截图。你知道那些黑箭头做什么吧？默认情况下，它们允许你执行合并/更改操作 – 当没有冲突时进行合并，并在同一行发生冲突时进行更改。</p>\n<p>但是你知道你可以根据需要删除个别的更改么？是的，这是可能的。为此，你需要做的是在处理更改时按下 Shift 键。你会观察到箭头被变成了十字架。</p>\n<p><a href=\"https://www.howtoforge.com/images/beginners-guide-to-visual-merge-tool-meld-on-linux-part-2/big/meld-delete-changes.png\"> <img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/09/c867a5a2a0153b0a72912ff16ef19151.png\" alt=\"Things you can do with changes\"></a></p>\n<p>只需点击其中任何一个，相应的更改将被删除。</p>\n<p>不仅是删除，你还可以确保冲突的更改不会在合并时更改行。例如，以下是一个冲突变化的例子：</p>\n<p><a href=\"https://www.howtoforge.com/images/beginners-guide-to-visual-merge-tool-meld-on-linux-part-2/big/meld-conflicting-change.png\"> <img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/09/746a354faaf438fa66001862e1956e1b.png\" alt=\"Delete changes in Meld\"></a></p>\n<p>现在，如果你点击任意两个黑色箭头，箭头指向的行将被改变，并且将变得与其他文件的相应行相似。只要你想这样做，这是没问题的。但是，如果你不想要更改任何行呢？相反，目的是将更改的行在相应行的上方或下方插入到其他文件中。</p>\n<p>我想说的是，例如，在上面的截图中，需要在 “test23” 之上或之下添加 “test 2”，而不是将 “test23” 更改为 “test2”。你会很高兴知道在 Meld 中这是可能的。就像你按下 Shift 键删除注释一样，在这种情况下，你必须按下 Ctrl 键。</p>\n<p>你会观察到当前操作将被更改为插入 – 双箭头图标将确认这一点 。</p>\n<p><a href=\"https://www.howtoforge.com/images/beginners-guide-to-visual-merge-tool-meld-on-linux-part-2/big/meld-ctrl-insert.png\"> <img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/09/d48a91909a13070aadaac9d3377057ba.png\" alt=\"Change actions\"></a></p>\n<p>从箭头的方向看，此操作可帮助用户将当前更改插入到其他文件中的相应更改 (如所选择的)。</p>\n<h3 id=\"toc_3\">3、 自定义文件在 Meld 的编辑器区域中显示的方式</h3>\n<p>有时候，你希望 Meld 的编辑区域中的文字大小变大（为了更好或更舒适的浏览），或者你希望文本行被包含而不是脱离视觉区域（意味着你不要想使用底部的水平滚动条）。</p>\n<p>Meld 在 <em>Editor</em> 选项卡（<em>Edit-&gt;Preferences-&gt;Editor</em>）的 <em>Preferences</em> 菜单中提供了一些显示和字体相关的自定义选项，你可以进行这些调整：</p>\n<p><a href=\"https://www.howtoforge.com/images/beginners-guide-to-visual-merge-tool-meld-on-linux-part-2/big/meld-editor-tab.png\"> <img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/09/e338b0cbc7bfbabd22b4ee2d44ff46d7.png\" alt=\"Meld preferences\"></a></p>\n<p>在这里你可以看到，默认情况下，Meld 使用系统定义的字体宽度。只需取消选中 <em>Font</em> 类别下的框，你将有大量的字体类型和大小选项可供选择。</p>\n<p>然后在 <em>Display</em> 部分，你将看到我们正在讨论的所有自定义选项：你可以设置 Tab 宽度、告诉工具是否插入空格而不是 tab、启用/禁用文本换行、使Meld显示行号和空白（在某些情况下非常有用）以及使用语法突出显示。</p>\n<h3 id=\"toc_4\">4、 过滤文本</h3>\n<p>有时候，并不是所有的修改都是对你很重要的。例如，在比较两个 C 编程文件时，你可能不希望 Meld 显示注释中的更改，因为你只想专注于与代码相关的更改。因此，在这种情况下，你可以告诉 Meld 过滤（或忽略）与注释相关的更改。</p>\n<p>例如，这里是 Meld 中的一个比较，其中由工具高亮了注释相关更改：</p>\n<p><a href=\"https://www.howtoforge.com/images/beginners-guide-to-visual-merge-tool-meld-on-linux-part-2/big/meld-changes-with-comments.png\"> <img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/09/fb371296bbb42b3f6f915ac9b972510b.png\" alt=\"Filter Text in Meld\"></a></p>\n<p>而在这种情况下，Meld 忽略了相同的变化，仅关注与代码相关的变更：</p>\n<p><a href=\"https://www.howtoforge.com/images/beginners-guide-to-visual-merge-tool-meld-on-linux-part-2/big/meld-changes-without-comments.png\"> <img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/09/90750b2dd9bb246c780ae1b82fced95e.png\" alt=\"Ignore Changes in Meld\"></a></p>\n<p>很酷，不是吗？那么这是怎么回事？为此，我是在 “<em>Edit-&gt;Preferences-&gt;Text Filters</em>” 标签中启用了 “C comments” 文本过滤器：</p>\n<p><a href=\"https://www.howtoforge.com/images/beginners-guide-to-visual-merge-tool-meld-on-linux-part-2/big/meld-text-filters.png\"> <img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/09/411274b89687a5a801c83b74a4310ac3.png\" alt=\"C-Comments in Meld\"></a></p>\n<p>如你所见，除了 “C comments” 之外，你还可以过滤掉 C++ 注释、脚本注释、引导或所有的空格等。此外，你还可以为你处理的任何特定情况定义自定义文本过滤器。例如，如果你正在处理日志文件，并且不希望 Meld 高亮显示特定模式开头的行中的更改，则可以为该情况定义自定义文本过滤器。</p>\n<p>但是，请记住，要定义一个新的文本过滤器，你需要了解 Python 语言以及如何使用该语言创建正则表达式。</p>\n<h3 id=\"toc_5\">总结</h3>\n<p>这里讨论的所有四个技巧都不是很难理解和使用（当然，除了你想立即创建自定义文本过滤器），一旦你开始使用它们，你会认为他们是真的有好处。这里的关键是要继续练习，否则你学到的任何技巧不久后都会忘记。</p>\n<p>你还知道或者使用其他任何中级 Meld 的贴士和技巧么？如果有的话，欢迎你在下面的评论中分享。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112348\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112348votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112348\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_path": "full/6085acc0af4696f5d49164561c6bc4f9b590fc26.jpg"}
